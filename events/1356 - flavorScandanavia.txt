namespace = scan_djm
#Written by DanJonMin, fixed by CountFlandy to work for 1.25
country_event = { #Perhaps we should tweak this to take into account queens and the new ruler triggers we have?
	id = scan_djm.1
	title = scan_djm.1.t
	desc = scan_djm.1.d
	picture = QUEEN_MARGARET_eventPicture
	
	fire_only_once = yes
	major = yes

	trigger = {
		tag = NOR
		#OR = {
			has_reform = elective_feudal_monarchy_reform
			#has_legacy_government = elective_feudal_monarchy
		#}
		OR = {
			marriage_with = DAN
			marriage_with = SWE
		}
		NOT = { is_year = 1430 }
	}
	
	mean_time_to_happen = {
		years = 40
		
		modifier = {
			factor = 0.05
			DAN = {
				has_ruler = "Margaret"
			}
		}

		modifier = {
			factor = 0.2
			is_year = 1400
		}
		
	}
	
	option = {
		ai_chance = { 
			factor = 50 
			
			modifier = {
				factor = 2
				NOT = { alliance_with = SWE }
				alliance_with = DAN
			}
			modifier = {
				factor = 2
				DAN = {
					dynasty = "Estridsen"
				}
			}
			
			modifier = {
				factor = 2
				DAN = {
					DIP = 5
				}
			}			
			
		}
		name = scan_djm.1.a
		add_adm_power = 100
		add_dip_power = 100
		add_mil_power = 100
		add_government_reform = feudalism_reform
		set_legacy_government = feudal_monarchy
		DAN = {
			create_union = NOR
		}
	}
	
	option = {
		ai_chance = { 
			factor = 20 
			
			modifier = {
				factor = 2
				NOT = { alliance_with = DAN }
				alliance_with = SWE
			}
			
			modifier = {
				factor = 2
				SWE = {
					DIP = 5
				}
			}			
		}
		name = scan_djm.1.c
		add_adm_power = 100
		add_dip_power = 100
		add_mil_power = 100
		add_government_reform = feudalism_reform
		set_legacy_government = feudal_monarchy
		SWE = {
			create_union = NOR
		}
	}	
	
	option = {
		name = scan_djm.1.b
		ai_chance = { 
			factor = 30
			
			modifier = {
				factor = 2
				alliance_with = DAN
				alliance_with = SWE
			}
			
		}
	
		add_stability = -1
		define_ruler = {
			adm = 1
			dip = 1
			mil = 1
		}
		DAN = {
			add_casus_belli = {
				type = cb_restore_personal_union
				months = 120
				target = NOR
			}
		}
		SWE = {
			add_casus_belli = {
				type = cb_restore_personal_union
				months = 120
				target = NOR
			}
		}
		add_republican_tradition = 0.50
	}
}

country_event = {
	id = scan_djm.2
	title = scan_djm.2.t
	desc = scan_djm.2.d
	picture = QUEEN_MARGARET_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = DAN
		NOT = { DAN = { senior_union_with = SWE } }
		OR = {
			SWE = { senior_union_with = MKL }
			DAN = { senior_union_with = NOR }
		}
		is_year = 1387
		NOT = { is_year = 1444 }
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = scan_djm.2.a
		add_casus_belli = {
			type = cb_restore_personal_union
			months = 120
			target = SWE
		}
		add_country_modifier = {
			name = "swedish_noble_support"
			duration = 1825
		}
	}
}

country_event = {
	id = scan_djm.3
	title = scan_djm.3.t
	desc = scan_djm.3.d
	picture = QUEEN_MARGARET_eventPicture
	
	fire_only_once = yes

	trigger = {
		OR = {
			tag = NOR
			tag = SWE
		}
		is_lesser_in_union = yes
		#OR = {
			has_reform = elective_feudal_monarchy_reform
			#has_legacy_government = elective_feudal_monarchy
		#}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = scan_djm.3.a
		add_government_reform = feudalism_reform
		set_legacy_government = feudal_monarchy
	}
}

country_event = {
	id = scan_djm.4
	title = scan_djm.4.t
	desc = scan_djm.4.d
	picture = LIBERUM_VETO_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = SWE
		NOT = { has_spawned_rebels = pretender_rebels }
		has_ruler = "Magnus IV"
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = scan_djm.4.a
		add_government_reform = feudalism_reform
		set_legacy_government = feudal_monarchy
		kill_heir = yes
		define_heir = {
			name = "Erik"
			monarch_name = "Erik XII"
			dynasty = "Bjelbo"
			birth_date = 1339.1.1
			claim = 75
			adm = 3
			dip = 3
			mil = 4
		}
	}
	
	option = {
		name = scan_djm.4.b
		add_stability = 1
		add_prestige = -15
	}
	
}

##############################
#  Written by Count Flandy   #
##############################

#Sweden Only
country_event = { #The Greenland Carrier Start
	id = scan_djm.5
	title = scan_djm.5.t
	desc = scan_djm.5.d
	picture = NAVAL_MILITARY_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = SWE
		current_age = age_of_feudalism
		1104 = { is_core = NOR }
		1105 = { is_core = NOR }
		is_subject = no
		is_at_war = no
	}
	
	mean_time_to_happen = {
		months = 200
	}
	
	option = { #Send the ship!
		name = scan_djm.5.a
		add_treasury = -20
		country_event = { 
			id = scan_djm.6
			days = 365
			random = 180
		}
	}	
	option = { #We can not afford this
		name = scan_djm.5.b
		add_prestige = 1
	}
	
}

#Sweden Only
country_event = { #The Greenland Carrier reports on Greenland
	id = scan_djm.6
	title = scan_djm.6.t
	desc = scan_djm.6.d
	picture = NAVAL_MILITARY_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
		
	option = { #Interesting...let us continue this!
		name = scan_djm.6.a
		set_country_flag = greenland_carrier_flag
		add_treasury = -50
		1104 = {
			add_permanent_province_modifier = { 
				name = groenlands_knorr_prov_modifier
				duration = -1  
			}
		}
		1105 = {
			add_permanent_province_modifier = { 
				name = groenlands_knorr_prov_modifier
				duration = -1  
			}
		}
		1 = {
			add_permanent_province_modifier = { 
				name = groenlands_knorr_stockholm_modifier
				duration = -1  
			}
		}
	}
	option = { #Interesting. Leave them to their own devices.
		name = scan_djm.6.b
	}
	
}

#Sweden Only
country_event = { #The Greenland Carrier Sinks
	id = scan_djm.7
	title = scan_djm.7.t
	desc = scan_djm.7.d
	picture = SHIP_SAILING_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = SWE
		has_country_flag = greenland_carrier_flag
		NOT = { stability = 0 }
	}
	
	mean_time_to_happen = {
		months = 500
	}
	
	option = { #Replace it!
		name = scan_djm.7.a
		add_treasury = -100
	}
	option = { #We can not afford this.
		name = scan_djm.7.b
		1104 = { remove_province_modifier = groenlands_knorr_prov_modifier }
		1105 = { remove_province_modifier = groenlands_knorr_prov_modifier }
		1 = { remove_province_modifier = groenlands_knorr_stockholm_modifier }
	}
	
}