namespace = yua

#Yuan event explaining everything
country_event = {
	id = yua.0
	title = yua.0.t
	desc = yua.0.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	fire_only_once = yes

	trigger = {
		tag = YUA
		start_date = 1356.12.25
		ai = no
		#has_switched_nation = no
	}
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = yua.0.a #Got it
		add_country_modifier = {
				name = "fall_of_yuan_mandate"
				duration = 5475
		}
	}
}

#Yuan event to change from Chinese tech to nomadic tech after loss of Mandate
country_event = {
	id = yua.1
	title = yua.1.t
	desc = yua.1.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = YUA
		NOT = { has_country_flag = no_longer_chinese_yua }
		NOT = { num_of_cities = 35 }
		NOT = {
			OR = {
				owns = 665
				owns = 670
				owns = 674
				owns = 682
				owns = 691
			}
		}
		OR = {
			is_emperor_of_china = no
			NOT = { owns = 1816 } #This might need tweaked for fairness for non chinese dlc owners
		}
	}
	mean_time_to_happen = {
		months = 12
	}
	
	option = { #Lose Chinese Tech, remove Manchu as accepted, become Kingdom rank, become steppe horde
		name = yua.1.a
		set_country_flag = no_longer_chinese_yua
		change_technology_group = nomad_group
		change_unit_type = nomad_group
		remove_accepted_culture = manchu
		set_government_rank = 2		
		change_government = steppe_horde
	}
}

country_event = { #Nomads want their dues now...
	id = yua.2
	title = yua.2.t
	desc = yua.2.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = YUA
		NOT = { is_year = 1500 }
		is_emperor_of_china = yes
		has_country_flag = yuan_asked_nomads_help_flag #From Decision
		has_country_flag = red_turban_rebellion_over_flag #Doesn't exist yet
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = { #Alright alright! Don't hurt us!
		name = yua.2.a
		custom_tooltip = yuan_nomad_gave_nomads_reward_for_loyalty_tooltip
		custom_tooltip = yuan_nomad_gave_nomads_reward_for_loyalty_2_tooltip
		yuan_nomad_gave_nomads_what_they_want_effect = yes
		add_years_of_income = -0.5
		add_prestige = -20
		add_meritocracy = -10
		add_adm_power = -100
		add_dip_power = -100
		add_mil_power = -100
			
	}
	option = { #Never! They're fools just like the Chinese!
		name = yua.2.b
		custom_tooltip = yuan_nomad_turned_back_on_deal_2_tooltip
		custom_tooltip = yuan_nomad_turned_back_on_deal_tooltip
		yuan_nomad_turned_back_on_deal_effect = yes
		add_stability = -1
		add_war_exhaustion = 4
		add_yearly_manpower = -0.5
		remove_accepted_culture = manchu
		remove_accepted_culture = khalkha
		remove_accepted_culture = oirats
		remove_accepted_culture = chahar
		remove_accepted_culture = buryat
	}
}

country_event = { 
	id = yua.3
	title = yua.3.t
	desc = yua.3.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes

	trigger = {
		always = no
		tag = YUA
		NOT = { is_year = 1500 }
		is_emperor_of_china = yes
		NOT = { has_country_flag = red_turban_rebellion_over_flag } #Doesn't exist yet
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = {
		name = yua.3.a
	}
	option = {
		name = yua.3.b
	}
}

country_event = { #Toqto Returns!
	id = yua.4
	title = yua.4.t
	desc = yua.4.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = YUA
		NOT = { is_year = 1400 }
		is_emperor_of_china = yes
		OR = {
			is_at_war = yes
			num_of_rebel_armies = 3
		}
	}
	mean_time_to_happen = {
		months = 50
		modifier = {
			factor = 0.5
			war_score = -25
		}
		modifier = {
			factor = 0.3
			war_score = -50
		}
		modifier = {
			factor = 0.5
			num_of_rebel_armies = 5
		}
		modifier = {
			factor = 0.1
			num_of_rebel_armies = 10
		}
		modifier = {
			factor = 2
			NOT = { num_of_rebel_armies = 1 }
		}
		modifier = {
			factor = 0.8
			NOT = { prestige = 0 }
		}
		modifier = {
			factor = 0.7
			exists = MNG
		}
		modifier = {
			factor = 0.9
			exists = QIC
		}
		modifier = {
			factor = 0.9
			exists = CXI
		}
		modifier = {
			factor = 0.9
			exists = SHU
		}
	}
	
	option = { #Yes! He shall be our savior!
		name = yua.4.a
		ai_chance = { factor = 30 }
		custom_tooltip = yua4a_toqto_returns_tooltip
		set_country_flag = yuan_toqto_returns_flag
		add_stability = -1
		add_prestige = -50
		add_meritocracy = -15
		add_manpower = 15
		define_advisor = {
			type = army_reformer
			name = "Toqto'a"
			location = 720
			discount = yes
			skill = 3
			culture = mongolian
			religion = vajrayana
		}
		define_general = {
			name = "Toqto'a"
			trait = inspirational_leader_general_personality
			shock = 5
			fire = 3
			manuever = 2
			siege = 2
		}
		add_historical_rival = KOR
		spawn_rebels = {
			type = noble_rebels
			size = 2
		}
	}
	option = { #I thought we exiled you! Guards! Kill this man!
		name = yua.4.b
		ai_chance = { factor = 70 }
		custom_tooltip = yua4b_killed_toqto_tooltip
		set_country_flag = yuan_toqto_killed_flag
		add_stability = 1
		add_prestige = 10
		add_meritocracy = 10
		add_manpower = -5
		define_consort = {
			name = "Lady Ki"
			country_of_origin = KOR
			dynasty = "Goryeo"
			culture = korean
			religion = mahayana
			adm = 5
			dip = 6
			mil = 3
			female = yes
		}
	}
}

country_event = { #Chinese Minors Lose manpower from Toqto's Return
	id = yua.5
	title = yua.5.t
	desc = yua.5.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes

	trigger = {
		culture_group = east_asian
		NOT = { is_year = 1400 }
		NOT = { has_country_flag = yua_chinese_minor_toqto_returned_flag }
		NOT = { has_country_flag = red_turban_rebellion_over_flag } #Doesn't exist yet
		has_country_flag = yuan_toqto_returns_flag
		is_emperor_of_china = no
		NOT = { tag = YUA }
		NOT = { tag = QNG }
		NOT = { tag = MCH }
		manpower = 5
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = { #Curses! We need a plan and fast!
		name = yua.5.a
		set_country_flag = yua_chinese_minor_toqto_returned_flag
		add_manpower = -5
		add_prestige = -10
		YUA = { 
			country_event = { 
				id = yua.6
				days = 30
				tooltip = yua.6_tooltip
			}
		}
	}
}

country_event = { #Yuan receives manpower from Chinese Minors
	id = yua.6
	title = yua.6.t
	desc = yua.6.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes

	
	option = { #Perfect!
		name = yua.6.a
		YUA = { 
			add_manpower = 5
		}
	}
}